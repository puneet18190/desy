<div class="griglia-contenuti">
  <div class="profile-content">
    <div class="title-bar">
      <h1><%= t('captions.profile') %></h1>
      <ul class="navlist">
        <li><%= link_to t('users.info.menu_link'), my_profile_path %></li>
        <li><%= link_to t('users.subjects.menu_link'), my_subjects_path %></li>
        <li><%= link_to t('users.mailing_list.menu_link'), my_mailing_lists_path %></li>
        <li><%= link_to t('users.statistics.menu_link'), my_statistics_path, :class => 'current' %></li>
      </ul>
    </div>
    <div class="contentForm">
      <header>
        <h2><%= t('users.statistics.title') %></h2>
        <p><%= t('users.statistics.description', :desy => SETTINGS['application_name']) %></p>
      </header>
      <div class="stats">
        <h2><%= t('users.statistics.personal.title') %></h2>
        <ul class="col fltlft">
          <li class="lesson_stat">
            <span class="fltlft"><%= t('users.statistics.personal.lessons_created') %></span><div><%= @my_created_lessons %></div>
          </li>
          <li class="lesson_stat">
            <span class="fltlft"><%= t('users.statistics.personal.lessons_copied_by') %></span><div><%=@my_copied_lessons%></div>
          </li>
          <li class="lesson_stat"><span class="fltlft"><%= t('users.statistics.personal.lessons_more_likes') %></span>
            <ul>
              <% @my_liked_lessons.each do |liked| %>
                <li><span><%= liked.title %></span><div><%= liked.likes_count %></div></li>
              <% end %>
            </ul>
          </li>
        </ul>
        <ul class="col fltrt">
          <li class="element_stat"><span><%= t('users.statistics.personal.media_elements_loaded') %></span><div><%= @my_created_elements %></div></li>
          <li class="generic_stat"><span><%= t('users.statistics.personal.likes') %></span><div><%= @my_likes_count %></div></li>
        </ul>
        <br style="clear:both" />
      </div>
    
      <div class="stats">
        <h2><%= t('users.statistics.general.title') %></h2>
        <ul class="col fltlft">
          <li class="lesson_stat"><span><%= t('users.statistics.general.lessons_shared') %></span><div><%= @all_shared_lessons %></div></li>
          <li class="element_stat"><span><%= t('users.statistics.general.media_elements_shared') %></span><div><%= @all_shared_elements %></div></li>
          <li class="generic_stat"><span><%= t('users.statistics.general.total_users') %></span><div><%= @all_users %></div></li>
          <li class="lesson_stat"><span><%= t('users.statistics.general.lessons_more_likes') %></span>
            <ul>
              <% @all_liked_lessons.each do |liked| %>
                <li><span><%= liked.title %></span><div><%= liked.likes_count %></div></li>
              <% end %>
            </ul>
          </li>
          <li class="generic_stat"><span><%= t('users.statistics.general.users_more_likes') %></span>
            <ul>
              <% @all_users_like.each do |u| %>
                <li><span><%= u.name %> <%= u.surname %></span><div><%= u.likes_count %></div></li>
              <% end %>
            </ul>
          </li>
        </ul>
        <ul class="col fltrt">
          <li class="element_stat chart">
            <%= t('users.statistics.general.percentual_lessons_subject.title') %>
            <br style="clear:both" />
            <table id="subjects-stats" width="100%" class="fltlft">
              <tr>
                <th><%= t('users.statistics.general.percentual_lessons_subject.color') %></th>
                <th><%= t('users.statistics.general.percentual_lessons_subject.subject') %></th>
                <th><%= t('users.statistics.general.percentual_lessons_subject.value') %></th>
              </tr>
              <% (0..@all_subjects_chart.count - 1).each do |index| %>
                <tr>
                  <td width="10%" border="1" style="background-color:<%=Subject.chart_colors[index]%>"></td>
                  <td width="70%"><%= @all_subjects_desc[index] %></td>
                  <td width="20%"><%= @all_subjects_chart[index] %>%</td>
                </tr>
              <% end %>
            </table>
            <span class="pie" data-text="<%= @all_subjects_desc %>" data-diameter="250" class="fltrt"><%= @all_subjects_chart.to_s[1..-2].gsub('"','') %></span>
            <br style="clear:both" />
          </li>
        </ul>
        <br style="clear:both" />
      </div>
    </div>
  </div>
</div>
<script type="text/javascript" charset="utf-8">
  $.fn.peity.defaults.pie = {
    colours: <%= Subject.chart_colors.to_json.html_safe %>,
    diameter: 250
  }
  
  $("span.pie").peity("pie");
</script>
