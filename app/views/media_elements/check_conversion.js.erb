var id = <%= @media_element_id %>;
var item = $('#expanded_media_element_' + id + ', #compact_media_element_' + id + ', #found_media_element_' + id);

<% if !@ok %>
  
  $('#notifications_main').replaceWith('<%= j(render :partial => "notifications/main", :locals => {:notifications => @notifications, :news => @new_notifications, :offset => @offset_notifications, :tot => @tot_notifications}) %>');
  if(item.length > 0) {
    // fai le cose qui, distinguendo tra compatto ed esteso
  }
  
<% elsif @media_element.converted? %>
  
  $('#notifications_main').replaceWith('<%= j(render :partial => "notifications/main", :locals => {:notifications => @notifications, :news => @new_notifications, :offset => @offset_notifications, :tot => @tot_notifications}) %>');
  if(item.length > 0) {
    var destination = item.attr('id').split('_')[0];
    if(destination == 'expanded') {
      item.replaceWith('<%= j(render :partial => "media_elements/view_single_expanded", :locals => {:media_element => @media_element, :destination => ButtonDestinations::EXPANDED_MEDIA_ELEMENT}) %>');
    } else if(destination == 'compact') {
      item.replaceWith('<%= j(render :partial => "media_elements/view_single_compact", :locals => {:media_element => @media_element, :destination => ButtonDestinations::COMPACT_MEDIA_ELEMENT}) %>');
    } else {
      item.replaceWith('<%= j(render :partial => "media_elements/view_single_compact", :locals => {:media_element => @media_element, :destination => ButtonDestinations::FOUND_MEDIA_ELEMENT}) %>');
    }
  }
  
<% end %>
