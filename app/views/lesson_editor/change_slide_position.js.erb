<% if @ok %>
  $('#nav_list_menu').data('jsp').destroy();
  var to_be_moved = $('#slide_in_lesson_editor_<%= @current_slide.id %>');
  var old_position = to_be_moved.data('position');
  var html_to_move = to_be_moved[0].outerHTML;
  to_be_moved.remove();
  var target_slide = $('#slide_in_lesson_editor_<%= @replaced_slide.id %>');
  if(old_position > <%= @position %>) {
    target_slide.before(html_to_move);
  } else {
    target_slide.after(html_to_move);
  }
  reInitializeSlidePositionsInLessonEditor();
  
  $("nav#heading #nav_list_menu").html("<%= j(render :partial => 'index_nav', :locals => {:slides => @slides, :with_current => false})%>");
  initializeSortableNavs();
  $('#nav_list_menu').jScrollPane({
    autoReinitialise: false
  });
  slideTo(<%= @current_slide.id %>);
<% else %>
  slideError();
<% end %>
