<div class="header">
  <div class="headerMenu">
  <ul>
    <li><%= link_to t('prelogin.main_page.menu_link'), root_path %></li>
    <li><%= link_to t('prelogin.what_is_desy.menu_link', :desy => SETTINGS['application_name']), what_is_desy_path %></li>
    <li><%= link_to t('prelogin.sign_up.menu_link'), sign_up_path, :class => 'current' %></li>
    <li><%= link_to t('prelogin.contact_us.menu_link'), contact_us_path %></li>
  </ul>
  <%= render :partial => "/prelogin/logo" %>
  </div>
</div>

<br class="clearfloat">
<div class="containerText">
  <h1><%= t('registration.title') %></h1>
  <h2><%= t('registration.subtitle') %></h2>
  <h3><%= t('registration.subsubtitle', :desy => SETTINGS['application_name']) %></h3>
  <p><%= t('registration.description', :desy => SETTINGS['application_name']) %></p>
</div>


<%= form_for @user do |f| %>
  <%= render partial: 'users/personal_info', :locals => { :f => f } %>
  <h2><%= t('registration.subjects.title') %></h2>
  <%= render partial: 'users/personal_subjects', :locals => { :f => f } %>

  <div class="contentForm">
    <% @user.registration_policies.each do |policy| %>
      <p>
        <strong><%= t("registration.#{policy}.title") %></strong><br><br>
        <%= t("registration.#{policy}.description") %>
      </p>
      <div class="checkbox-content">
        <div class="checkboxElement">
          <table>
            <tr>
              <td>
                <% if @user.errors.include?(policy) %>
                  <div class="field_with_errors">
                <% end %>

                <%= f.hidden_field policy, value: '0', id: nil %>
                <%= check_box_tag "user[#{policy}]", '1', @user.send(policy) == '1', class: 'regular-checkbox' %>
                <%= label_tag "user[#{policy}]", '' %>

                <% if @user.errors.include?(policy) %>
                  </div>
                <% end %>
              </td>
              <td>accept</td>
            </tr>
          </table>
        </div>
        
      </div>

      <br class="clearfloat">
    <% end %>
    
    <%# ERRORI %>
    <% errors = @user.errors.select{ |k,_| @user.registration_policies.include? k } %>

    <ul class="listaErrori">
    <% errors.each do |k, v| %>
      <li><%= @user.errors.full_message(k, v) %></li>
    <% end if errors.present? %>
    </ul>

    <%= f.submit t('registration.done') %>
  </div>

<% end %>


