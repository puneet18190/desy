<div class="header">
  <div class="headerMenu">
    <ul>
      <li><%= link_to t('prelogin.main_page.menu_link'), root_path %></li>
      <li><%= link_to t('prelogin.what_is_desy.menu_link', :desy => SETTINGS['application_name']), what_is_desy_path %></li>
      <li><%= link_to t('prelogin.sign_up.menu_link'), sign_up_path, :class => 'current' %></li>
      <li><a href="mailto:<%= SETTINGS['application']['maintainer']['emails'][0] %>"><%= t('prelogin.contact_us.menu_link') %></a></li>
    </ul>
    <div class="logoDesyPrelogin fltrt">
    <%= image_tag "logo_prelogin_small.png" %>
    <p style="color:white">DIGITAL EDUCATION SYSTEM</p>
    </div> 
  </div>
</div>

<br class="clearfloat">
<div class="containerText">
  <h1><%= t('registration.title') %></h1>
  <h2><%= t('registration.subtitle', :desy => SETTINGS['application_name']) %></h2>
  <p><%= t('registration.description', :desy => SETTINGS['application_name']) %></p>
</div>


<%= form_for @user do |f| %>
  <%= render partial: 'users/personal_info', :locals => { :f => f } %>
  <h2><%= t('registration.subjects.title') %></h2>
  <%= render partial: 'users/personal_subjects', :locals => { :f => f } %>

  <div class="contentForm">
    <% @user.registration_policies.each do |policy| %>
      <p>
        <strong><%= t("registration.#{policy}.title") %></strong><br><br>
        <%= t("registration.#{policy}.description") %>
      </p>
      <div class="checkbox-content">
        <div class="checkboxElement">
          <table>
            <tr>
              <td>
                <% if @user.errors.include?(policy) %>
                  <div class="field_with_errors">
                <% end %>

                <%= f.hidden_field policy, value: '0', id: nil %>
                <%= check_box_tag "user[#{policy}]", '1', @user.send(policy) == '1', class: 'regular-checkbox' %>
                <%= label_tag "user[#{policy}]", '' %>

                <% if @user.errors.include?(policy) %>
                  </div>
                <% end %>
              </td>
              <td><%= t("registration.#{policy}.accept") %></td>
            </tr>
          </table>
        </div>
        
      </div>

      <br class="clearfloat">



    <% end %>
    
    <%# ERRORI %>
    <% errors = @user.errors.select{ |k,_| @user.registration_policies.include? k } %>

    <ul class="listaErrori">
    <% errors.each do |k, v| %>
      <li><%= @user.errors.full_message(k, v) %></li>
    <% end if errors.present? %>
    </ul>

    <%= f.submit t('registration.done') %>

  </div>

<% end %>
  <br class="clearfloat">
  <div class="footer">
    <div class="fltlft" >
      <img src="<%= asset_path 'partner_logo.jpg' %>">
    </div>
    <div class="fltrt" style="padding-top:20px">
      <%= SETTINGS['application_copyright'] %>
    </div>
  </div>
