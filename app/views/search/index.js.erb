<%
  my_current_url = remove_param_from_url(request.url, 'delete_item')
  my_current_url = add_page_parameter(@page, my_current_url)
%>

<% if @search_item == 'media_elements' %>
  
  <% if @delete_item.blank? %>
    $('#found_media_elements').hide('fade', {}, 500, function() {
      $('#found_media_elements').replaceWith("<%= j(render(:partial => "search/media_elements/results")) %>");
      $('#found_lessons').html('');
      <% if @media_elements.any? %>
        $('#general_pagination').replaceWith("<%= j(render(:partial => 'shared/pagination', :locals => {:page => @page, :pages_amount => @pages_amount, :pagination_url => my_current_url})) %>");
      <% else %>
        $('#general_pagination').html('');
      <% end %>
    });
  <% else %>
    var to_delete = $('#<%= @delete_item %>');
    to_delete.hide('fade', {}, 500, function() {
      $('#found_media_elements').replaceWith("<%= j(render(:partial => "search/media_elements/results")) %>");
      $('#found_lessons').html('');
      <% if @media_elements.any? %>
        $('#general_pagination').replaceWith("<%= j(render(:partial => 'shared/pagination', :locals => {:page => @page, :pages_amount => @pages_amount, :pagination_url => my_current_url})) %>");
      <% else %>
        $('#general_pagination').html('');
      <% end %>
    });
  <% end %>
  
  <% if @tags.any? %>
    $('#media_elements_tag_details').replaceWith("<%= j(render(:partial => 'search/media_elements/tag_details', :locals => {:tags => @tags})) %>");
  <% end %>
  
<% else %>
  
  <% if @delete_item.blank? %>
    $('#found_lessons').hide('fade', {}, 500, function() {
      $('#found_lessons').replaceWith("<%= j(render(:partial => "search/lessons/results")) %>");
      $('#found_media_elements').html('');
      <% if @lessons.any? %>
        $('#general_pagination').replaceWith("<%= j(render(:partial => 'shared/pagination', :locals => {:page => @page, :pages_amount => @pages_amount, :pagination_url => my_current_url})) %>");
      <% else %>
        $('#general_pagination').html('');
      <% end %>
    });
  <% else %>
    var to_delete = $('#<%= @delete_item %>');
    to_delete.hide('fade', {}, 500, function() {
      $('#found_lessons').replaceWith("<%= j(render(:partial => "search/lessons/results")) %>");
      $('#found_media_elements').html('');
      <% if @lessons.any? %>
        $('#general_pagination').replaceWith("<%= j(render(:partial => 'shared/pagination', :locals => {:page => @page, :pages_amount => @pages_amount, :pagination_url => my_current_url})) %>");
      <% else %>
        $('#general_pagination').html('');
      <% end %>
    });
  <% end %>
  
  <% if @tags.any? %>
    $('#lessons_tag_details').replaceWith("<%= j(render(:partial => 'search/lessons/tag_details', :locals => {:tags => @tags})) %>");
  <% end %>
  
<% end %>

$('#info_container').data('currenturl', '<%= remove_param_from_url(request.url, 'delete_item') %>');
