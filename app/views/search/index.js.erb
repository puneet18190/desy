<%
  my_current_url = manipulate_request_url(remove_query_param: 'delete_item', page: @page)
  my_item = 'lessons'
  my_other_item = 'media_elements'
  my_objects = @lessons
  my_objects_amount = @lessons_amount
  if @search_item == 'media_elements'
    my_item = 'media_elements'
    my_other_item = 'lessons'
    my_objects = @media_elements
    my_objects_amount = @media_elements_amount
  end
%>

<% if @delete_item.blank? %>
  $('#found_<%= my_item %>').hide('fade', {}, 500, function() {
    $('#found_<%= my_item %>').replaceWith("<%= j(render(:partial => "search/#{my_item}/results")) %>");
    $('#found_<%= my_other_item %>').html('');
    $('#<%= my_other_item %>_tag_details').html('');
    $('#<%= my_other_item %>_search_amount').html('');
    <% if my_objects.any? %>
      $('#general_pagination').replaceWith("<%= j(render(:partial => 'shared/pagination', :locals => {:page => @page, :pages_amount => @pages_amount, :pagination_url => my_current_url})) %>");
    <% else %>
      $('#general_pagination').html('');
    <% end %>
  });
<% else %>
  var to_delete = $('#<%= @delete_item %>');
  to_delete.hide('fade', {}, 500, function() {
    $('#found_<%= my_item %>').replaceWith("<%= j(render(:partial => "search/#{my_item}/results")) %>");
    $('#found_<%= my_other_item %>').html('');
    <% if my_objects.any? %>
      $('#general_pagination').replaceWith("<%= j(render(:partial => 'shared/pagination', :locals => {:page => @page, :pages_amount => @pages_amount, :pagination_url => my_current_url})) %>");
    <% else %>
      $('#general_pagination').html('');
    <% end %>
  });
<% end %>

<% if my_objects_amount > 0 || @tag.kind_of?(Tag) %>
  $('#<%= my_item %>_search_amount').replaceWith("<%= j(render(:partial => "search/#{my_item}/amount", :locals => {:amount => my_objects_amount})) %>");
<% else %>
  $('#<%= my_item %>_search_amount').html('');
<% end %>

<% if (my_objects_amount > 0 && @tags.any?) %>
  $('#<%= my_item %>_tag_details').replaceWith("<%= j(render(:partial => "search/#{my_item}/tag_details", :locals => {:tags => @tags, :tag => @tag})) %>");
<% elsif @tag.kind_of?(Tag) %>
  $('._clickable_tag_for_<%= my_item %>').removeClass('current');
  $('#clickable_tag_<%= @tag.id %>').addClass('current');
<% else %>
  $('#<%= my_item %>_tag_details').html('');
  $('#<%= my_item %>_tag_details').css('margin-bottom', '0');
<% end %>

$('#info_container').data('currenturl', '<%= manipulate_request_url({:remove_query_param => "delete_item"}) %>');
