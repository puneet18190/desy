<%
  doc_empty = documents.empty?
  display_docs = (documents_slides.length >= 3 || doc_empty) ? ['none', 'block'] : ['block', 'none']
%>

<div id="document_gallery" class="document_gallery document-kind" data-empty="<%= doc_empty %>">
  
  <div id="inputs_for_documents" style="display:none">
    <% i = 1 %>
    <% documents_slides.each do |ds| %>
      <input type="text" name="document_<%= i %>" value="<%= ds.document_id %>" />
      <% i += 1 %>
    <% end %>
  </div>
  
  <div class="attachedExternal">
    <div class="attachedInternal">
      <% [1, 2, 3].each do |i| %>
        <% if documents_slides[i - 1].nil? %>
          <div id="document_<%= i %>_attached" class="document_attached documentInGalleryExternal not_full" style="margin-bottom:<%= (i == 3) ? '0' : '2px' %>">
            <div class="document_number"><%= i %></div>
            <div class="document_placeholder"><%= t('galleries.documents.placeholder') %></div>
          </div>
        <% else %>
          <div id="document_<%= i %>_attached" class="document_attached documentInGalleryExternal" style="margin-bottom:<%= (i == 3) ? '0' : '2px' %>">
            <%= render :partial => 'galleries/thumbs/document', :locals => {:document => documents_slides[i - 1].document, :disabled => false} %>
          </div>
        <% end %>
        <div id="document_<%= i %>_attached_empty" style="display:none">
          <div class="document_number"><%= i %></div>
          <div class="document_placeholder"><%= t('galleries.documents.placeholder') %></div>
        </div>
      <% end %>
    </div>
  </div>
  
  <div class="documentsExternal">
    <div class="for-scroll-pain" style="display:<%= display_docs[0] %>">
      <% documents.each_with_index do |document, index| %>
        <%
          margin = (index == 0) ? "style=\"margin-top:0\"".html_safe : ''
          plucks = documents_slides.pluck(:document_id)
        %>
        <div id="gallery_document_<%= document.id %>" class="documentInGalleryExternal" <%= margin %>>
          <%= render :partial => 'galleries/thumbs/document', :locals => {:document => document, :disabled => plucks.include?(document.id)} %>
        </div>
      <% end %>
    </div>
    <div id="empty_document_gallery" style="display:<%= display_docs[1] %>">
      <div class="bigDocumentIcon"></div>
      <br class="clearfloat"/>
      <% if doc_empty %>
        <p><%= t('galleries.empty.document') %></p>
      <% else %>
        <p><%= t('galleries.documents.locked') %></p>
      <% end %>
    </div>
  </div>
  
  <div class="documentsFooter">
    <div class="triangolo" style="display:<%= display_docs[0] %>"></div>
    <div class="footerLeft" style="display:<%= display_docs[0] %>">
      <p class="filterBy lower"><%= t('galleries.documents.filter_by') %></p>
      <input id="document_gallery_filter" type="text" value="" class="filterByInput" data-letters="0" style="color:#999">
      <%= image_tag 'cerca_documenti.gif', :class => '_loader', :style => 'display:none; float:right' %>
    </div>
    <div class="footerButtons">
      <div class="lower cancel button"><%= t('galleries.documents.cancel') %></div>
      <div class="lower attach button"><%= t('galleries.documents.done') %></div>
    </div>
  </div>
  
</div>
