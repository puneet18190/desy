var wrs_int_opener,closeFunction;if(window.opener)wrs_int_opener=window.opener,closeFunction=window.close;else for(wrs_int_opener=window.parent;wrs_int_opener.InnerDialogLoaded;)wrs_int_opener=wrs_int_opener.parent;window.parent.InnerDialogLoaded?(window.parent.InnerDialogLoaded(),closeFunction=window.parent.Cancel):window.opener.parent.FCKeditorAPI&&(wrs_int_opener=window.opener.parent),wrs_int_opener.wrs_addEvent(window,"load",function(){var e,n=wrs_int_opener.wrs_getQueryParams(window);"wrs_attributes"in window?wrs_attributes.language=n.lang:wrs_attributes={language:n.lang},e=com.wiris.jsEditor.defaultBasePath?com.wiris.jsEditor.JsEditor.newInstance(wrs_attributes):new com.wiris.jsEditor.JsEditor("editor",null);var t=e.getElement(),r=document.getElementById("editorContainer");if(e.insertInto(r),!wrs_int_opener._wrs_isNewElement){var i,o=wrs_int_opener._wrs_temporalImage.getAttribute(wrs_int_opener._wrs_conf_imageMathmlAttribute);null==o&&(o=wrs_int_opener._wrs_temporalImage.getAttribute("alt")),i=wrs_int_opener._wrs_conf_useDigestInsteadOfMathml?wrs_int_opener.wrs_getCode(wrs_int_opener._wrs_conf_digestPostVariable,o):wrs_int_opener.wrs_mathmlDecode(o),e.setMathML(i)}var s=document.getElementById("controls"),a=document.createElement("input");a.type="button",a.value=null!=strings.accept?strings.accept:"Accept",wrs_int_opener.wrs_addEvent(a,"click",function(){var t="";e.isFormulaEmpty()||(t+=e.getMathML(),t=wrs_int_opener.wrs_mathmlEntities(t)),window.parent.InnerDialogLoaded&&window.parent.FCKBrowserInfo.IsIE?(closeFunction(),wrs_int_opener.wrs_int_updateFormula(t,wrs_int_opener._wrs_editMode,n.lang)):(wrs_int_opener.wrs_int_updateFormula&&wrs_int_opener.wrs_int_updateFormula(t,wrs_int_opener._wrs_editMode,n.lang),closeFunction())}),s.appendChild(a);var _=document.createElement("input");_.type="button",_.value=null!=strings.cancel?strings.cancel:"Cancel",wrs_int_opener.wrs_addEvent(_,"click",function(){closeFunction()}),s.appendChild(_);var w=document.getElementById("a_manual");"undefined"!=typeof w&&null!=strings.manual&&(w.innerHTML=strings.manual);var l=document.getElementById("a_latex");"undefined"!=typeof l&&null!=strings.latex&&(l.innerHTML=strings.latex);var d="";if("lang"in n&&(d=n.lang.substr(0,2)),"rtl"==n.dir||("he"==d||"ar"==d)&&"ltr"!=n.dir){var u=document.getElementsByTagName("BODY");u[0].setAttribute("dir","rtl");var c=document.getElementById("links");c.id="links_rtl";var s=document.getElementById("controls");s.id="controls_rtl"}setInterval(function(){t.style.height=document.getElementById("container").offsetHeight-s.offsetHeight-10+"px"},100),setTimeout(function(){e.focus()},100)}),wrs_int_opener.wrs_addEvent(window,"unload",function(){wrs_int_opener.wrs_int_notifyWindowClosed()});