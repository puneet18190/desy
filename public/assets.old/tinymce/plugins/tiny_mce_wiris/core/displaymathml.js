function generateEntities(e){for(d="",i=0;i<e.length;i++)c=e.charCodeAt(i),d+=c>=128?"&#"+c+";":e.charAt(i);return d}function isInAContentEditableElement(e){return null==e?!1:e.contentEditable&&"inherit"!==e.contentEditable?!0:isInAContentEditableElement(e.parentNode)}function fixVerticalAlign(e){e.align="",e.style.verticalAlign=-e.height/2+"px"}function fixVerticalAlignForAll(){for(var e=document.getElementsByTagName("img"),t=e.length-1;t>=0;--t)"Wirisformula"!=e[t].className||isInAContentEditableElement(e[t])||(e[t].align="",e[t].style.verticalAlign=-e[t].height/2+"px")}function mathmlFunction(){var e=document.getElementsByTagName("math");for(i=0;i<e.length;i++){var t=e[i],n=document.createElement("span");n.className="wrs_viewer",t.parentNode.replaceChild(n,t),n.appendChild(t);var a=n.innerHTML;0==a.indexOf("<?XML")&&(j=a.indexOf("/>"),j>=0&&(a=a.substring(j+2)));var l=document.createElement("img");a=generateEntities(a),null!=l.attachEvent&&l.attachEvent("onload",function(){fixVerticalAlign(l)}),l.src="http://localhost/aspx-demo_nicedit_wiris/nicedit/nicedit_wiris/integration/showimage.aspx?mml="+encodeURIComponent(a),l.align="middle",l.className="Wirisformula",n.parentNode.replaceChild(l,n)}}window.attachEvent&&window.attachEvent("onload",mathmlFunction),window.addEventListener("load",mathmlFunction,!1);